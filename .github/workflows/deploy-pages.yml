name: Deploy to GitHub Pages

on:
  push:
    branches: [ master ]
  workflow_dispatch:  # Allows manual trigger from Actions tab

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Setup Pages
      uses: actions/configure-pages@v4

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'

    - name: Create package.json and install dependencies
      run: |
        cat > package.json << 'PKGJSON'
        {
          "name": "cs-basics-site",
          "version": "1.0.0",
          "dependencies": {
            "markdown-it": "^14.0.0",
            "markdown-it-anchor": "^9.0.1"
          }
        }
        PKGJSON
        npm install

    - name: Create website directory and copy images
      run: |
        mkdir -p _site/doc
        # Copy images directory to preserve image links
        cp -r doc/pic _site/doc/pic

    - name: Convert README to HTML
      run: |
        cat > build-site.js << 'BUILDSCRIPT'
        const fs = require('fs');
        const path = require('path');
        const MarkdownIt = require('markdown-it');
        const markdownItAnchor = require('markdown-it-anchor');

        const md = new MarkdownIt({
          html: true,
          linkify: true,
          typographer: true
        }).use(markdownItAnchor, {
          permalink: true,
          permalinkBefore: true,
          permalinkSymbol: '#'
        });

        // Function to process links - convert cheatsheet links to internal, keep GitHub code links as external
        function processLinks(html) {
          // Convert cheatsheet GitHub links to internal links
          html = html.replace(
            /https:\/\/github\.com\/yennanliu\/CS_basics\/blob\/master\/doc\/cheatsheet\/([^")\s]+\.md)/g,
            (match, filename) => {
              const baseName = filename.replace('.md', '');
              return `${baseName}.html`;
            }
          );

          // Ensure all other GitHub links stay as GitHub links (don't transform them)
          // This includes code files in leetcode_java, leetcode_python, etc.

          return html;
        }

        // Read README
        const readme = fs.readFileSync('README.md', 'utf8');
        const content = processLinks(md.render(readme));

        // Read Resource.md if exists
        let resourceContent = '';
        if (fs.existsSync('doc/Resource.md')) {
          const resource = fs.readFileSync('doc/Resource.md', 'utf8');
          resourceContent = processLinks(md.render(resource));
        }

        // Function to generate table of contents
        function generateTOC(htmlContent) {
          const headingRegex = /<h([23])[^>]*>(.*?)<\/h\1>/g;
          const headings = [];
          let match;

          while ((match = headingRegex.exec(htmlContent)) !== null) {
            const level = match[1];
            const text = match[2].replace(/<[^>]*>/g, ''); // Remove HTML tags
            const id = text.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, '');
            headings.push({ level, text, id });
          }

          if (headings.length < 3) return ''; // Don't show TOC for short documents

          let toc = '<div class="toc"><h2>Table of Contents</h2><ul>';
          headings.forEach(({ level, text, id }) => {
            const indent = level === '3' ? ' class="toc-sub"' : '';
            toc += `<li${indent}><a href="#${id}">${text}</a></li>`;
          });
          toc += '</ul></div>';

          return toc;
        }

        // Function to add IDs to headings for TOC navigation
        function addHeadingIds(htmlContent) {
          return htmlContent.replace(/<h([23])([^>]*)>(.*?)<\/h\1>/g, (match, level, attrs, text) => {
            const cleanText = text.replace(/<[^>]*>/g, '');
            const id = cleanText.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, '');
            return `<h${level}${attrs} id="${id}">${text}</h${level}>`;
          });
        }

        // Process all cheatsheet files
        const cheatsheetDir = 'doc/cheatsheet';
        const cheatsheets = [];

        if (fs.existsSync(cheatsheetDir)) {
          const files = fs.readdirSync(cheatsheetDir)
            .filter(f => f.endsWith('.md') && f !== 'README.md' && f !== '00_template.md')
            .sort();

          // Group cheatsheets by category
          const categories = {
            'Core Data Structures': ['array', 'linked_list', 'tree', 'binary_tree', 'bst', 'graph', 'stack', 'queue', 'heap', 'hash_map', 'set', 'trie'],
            'Search & Sort': ['binary_search', 'dfs', 'bfs', 'sort', 'topology_sorting'],
            'Algorithm Patterns': ['2_pointers', 'sliding_window', 'backtrack', 'dp', 'greedy', 'recursion'],
            'Advanced Topics': ['union_find', 'segment_tree', 'binary_indexed_tree', 'monotonic_stack', 'prefix_sum', 'difference_array'],
            'Graph Algorithms': ['Dijkstra', 'Bellman-Ford', 'Floyd-Warshall'],
            'Specialized': ['bit_manipulation', 'math', 'string', 'matrix', 'intervals', 'design', 'iterator']
          };

          files.forEach(file => {
            const filePath = path.join(cheatsheetDir, file);
            const rawContent = fs.readFileSync(filePath, 'utf8');
            const baseName = path.basename(file, '.md');
            const title = baseName.replace(/_/g, ' ')
              .split(' ')
              .map(word => word.charAt(0).toUpperCase() + word.slice(1))
              .join(' ');

            // Render and process links
            let htmlContent = md.render(rawContent);
            htmlContent = processLinks(htmlContent);
            htmlContent = addHeadingIds(htmlContent);

            // Generate table of contents
            const toc = generateTOC(htmlContent);

            // Wrap content with navigation and better structure
            const wrappedContent = `
              <div class="cheatsheet-header">
                <a href="../cheatsheets.html" class="back-link">‚Üê Back to Cheat Sheets</a>
                <h1>${title}</h1>
              </div>
              ${toc}
              <div class="cheatsheet-content">
                ${htmlContent}
              </div>
              <div class="cheatsheet-footer">
                <a href="../cheatsheets.html" class="back-link">‚Üê Back to Cheat Sheets</a>
                <a href="https://github.com/yennanliu/CS_basics/blob/master/doc/cheatsheet/${file}" class="github-edit" target="_blank">
                  Edit on GitHub ‚Üí
                </a>
              </div>
            `;

            cheatsheets.push({
              file: baseName,
              title: title,
              content: wrappedContent,
              category: null
            });
          });

          // Assign categories
          cheatsheets.forEach(sheet => {
            for (const [category, keywords] of Object.entries(categories)) {
              if (keywords.some(kw => sheet.file.includes(kw) || sheet.file === kw)) {
                sheet.category = category;
                break;
              }
            }
            if (!sheet.category) {
              sheet.category = 'Other';
            }
          });
        }

        // Create cheatsheet index
        let cheatsheetIndexContent = '<h1>Algorithm & Data Structure Cheat Sheets</h1>';
        cheatsheetIndexContent += '<p class="intro">Comprehensive collection of algorithm patterns, data structures, and problem-solving techniques.</p>';

        // Group by category
        const grouped = {};
        cheatsheets.forEach(sheet => {
          if (!grouped[sheet.category]) {
            grouped[sheet.category] = [];
          }
          grouped[sheet.category].push(sheet);
        });

        // Generate index with categories
        const categoryOrder = ['Core Data Structures', 'Search & Sort', 'Algorithm Patterns', 'Advanced Topics', 'Graph Algorithms', 'Specialized', 'Other'];

        categoryOrder.forEach(category => {
          if (grouped[category] && grouped[category].length > 0) {
            cheatsheetIndexContent += `<h2>${category}</h2><div class="cheatsheet-grid">`;
            grouped[category].forEach(sheet => {
              cheatsheetIndexContent += `
                <div class="cheatsheet-card">
                  <h3><a href="cheatsheets/${sheet.file}.html">${sheet.title}</a></h3>
                  <p><a href="cheatsheets/${sheet.file}.html" class="read-more">Read more ‚Üí</a></p>
                </div>`;
            });
            cheatsheetIndexContent += '</div>';
          }
        });

        cheatsheetIndexContent += `
        <div style="margin-top: 3rem; padding: 1.5rem; background: var(--bg-secondary); border-radius: 8px;">
          <p><strong>üí° Tip:</strong> These cheatsheets are designed for quick reference during coding interviews and problem-solving.</p>
          <p>View all cheatsheets on <a href="https://github.com/yennanliu/CS_basics/tree/master/doc/cheatsheet">GitHub</a>.</p>
        </div>`;

        // Create HTML template
        const htmlTemplate = (title, bodyContent, currentPage = 'home') => `
        <!DOCTYPE html>
        <html lang="en">
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>${title} - CS_basics</title>
          <meta name="description" content="Computer Science fundamentals: algorithms, data structures, system design, and LeetCode solutions">
          <link rel="stylesheet" href="style.css">
          <link rel="preconnect" href="https://fonts.googleapis.com">
          <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
          <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
        </head>
        <body>
          <nav class="navbar">
            <div class="container">
              <div class="nav-brand">
                <span class="nav-icon">üíª</span>
                <span class="nav-title">CS_basics</span>
              </div>
              <div class="nav-links">
                <a href="index.html" class="${currentPage === 'home' ? 'active' : ''}">Home</a>
                <a href="resources.html" class="${currentPage === 'resources' ? 'active' : ''}">Resources</a>
                <a href="cheatsheets.html" class="${currentPage === 'cheatsheets' ? 'active' : ''}">Cheat Sheets</a>
                <a href="https://github.com/yennanliu/CS_basics" target="_blank" class="github-link">
                  <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                  </svg>
                  GitHub
                </a>
              </div>
            </div>
          </nav>

          <main class="container">
            <div class="content">
              ${bodyContent}
            </div>
          </main>

          <footer>
            <div class="container">
              <p>CS_basics - Computer Science Fundamentals & Interview Preparation</p>
              <p>
                <a href="https://github.com/yennanliu/CS_basics">GitHub</a> ‚Ä¢
                <a href="https://github.com/yennanliu/CS_basics/tree/master/doc">Documentation</a> ‚Ä¢
                <a href="https://github.com/yennanliu/CS_basics/issues">Report Issues</a>
              </p>
            </div>
          </footer>
        </body>
        </html>
        `;

        // Write index.html
        fs.writeFileSync('_site/index.html', htmlTemplate('Home', content, 'home'));
        console.log('‚úì Created index.html');

        // Write resources.html
        if (resourceContent) {
          fs.writeFileSync('_site/resources.html', htmlTemplate('Resources', resourceContent, 'resources'));
          console.log('‚úì Created resources.html');
        }

        // Write cheatsheets index
        fs.writeFileSync('_site/cheatsheets.html', htmlTemplate('Cheat Sheets', cheatsheetIndexContent, 'cheatsheets'));
        console.log('‚úì Created cheatsheets.html index');

        // Create cheatsheets directory and write individual pages
        if (cheatsheets.length > 0) {
          fs.mkdirSync('_site/cheatsheets', { recursive: true });

          cheatsheets.forEach(sheet => {
            const cheatsheetHtml = htmlTemplate(sheet.title, sheet.content, 'cheatsheets');
            fs.writeFileSync(`_site/cheatsheets/${sheet.file}.html`, cheatsheetHtml);
          });

          console.log(`‚úì Created ${cheatsheets.length} individual cheatsheet pages`);
        }

        console.log('‚úì Website built successfully!');
        BUILDSCRIPT

        node build-site.js

    - name: Create CSS
      run: |
        cat > _site/style.css << 'EOFCSS'
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        :root {
          --primary-color: #3b82f6;
          --secondary-color: #2563eb;
          --accent-color: #8b5cf6;
          --text-color: #1f2937;
          --text-light: #6b7280;
          --bg-color: #ffffff;
          --bg-secondary: #f9fafb;
          --border-color: #e5e7eb;
          --code-bg: #f3f4f6;
          --success-color: #10b981;
        }

        body {
          font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          color: var(--text-color);
          background-color: var(--bg-color);
          line-height: 1.6;
        }

        /* Navbar */
        .navbar {
          background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
          color: white;
          padding: 1rem 0;
          box-shadow: 0 2px 8px rgba(0,0,0,0.1);
          position: sticky;
          top: 0;
          z-index: 100;
        }

        .navbar .container {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .nav-brand {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 1.5rem;
          font-weight: 700;
        }

        .nav-icon {
          font-size: 2rem;
        }

        .nav-links {
          display: flex;
          gap: 2rem;
          align-items: center;
        }

        .nav-links a {
          color: white;
          text-decoration: none;
          font-weight: 500;
          transition: opacity 0.2s;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .nav-links a:hover {
          opacity: 0.8;
        }

        .nav-links a.active {
          border-bottom: 2px solid white;
        }

        .github-link {
          background: rgba(255,255,255,0.2);
          padding: 0.5rem 1rem;
          border-radius: 6px;
        }

        /* Container */
        .container {
          max-width: 1200px;
          margin: 0 auto;
          padding: 0 2rem;
        }

        /* Main Content */
        main {
          padding: 3rem 0;
          min-height: calc(100vh - 200px);
        }

        .content {
          background: white;
          padding: 3rem;
          border-radius: 12px;
          box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        /* Typography */
        h1 {
          font-size: 2.5rem;
          font-weight: 700;
          margin-bottom: 1.5rem;
          color: var(--text-color);
          border-bottom: 3px solid var(--primary-color);
          padding-bottom: 0.5rem;
        }

        h2 {
          font-size: 2rem;
          font-weight: 600;
          margin-top: 2.5rem;
          margin-bottom: 1rem;
          color: var(--text-color);
        }

        h3 {
          font-size: 1.5rem;
          font-weight: 600;
          margin-top: 2rem;
          margin-bottom: 0.75rem;
          color: var(--text-color);
        }

        h4 {
          font-size: 1.25rem;
          font-weight: 600;
          margin-top: 1.5rem;
          margin-bottom: 0.5rem;
        }

        p {
          margin-bottom: 1rem;
          color: var(--text-color);
        }

        a {
          color: var(--primary-color);
          text-decoration: none;
        }

        a:hover {
          text-decoration: underline;
        }

        /* Code Blocks */
        code {
          background: var(--code-bg);
          padding: 0.2rem 0.5rem;
          border-radius: 4px;
          font-family: 'JetBrains Mono', 'Monaco', 'Menlo', monospace;
          font-size: 0.9em;
          color: #e83e8c;
          font-weight: 500;
        }

        pre {
          background: #1e293b;
          padding: 1.5rem;
          border-radius: 8px;
          overflow-x: auto;
          margin: 1.5rem 0;
          border-left: 4px solid var(--primary-color);
          box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        pre code {
          background: none;
          padding: 0;
          color: #e2e8f0;
          font-size: 0.875rem;
          font-weight: 400;
          line-height: 1.6;
        }

        /* Inline code in headings */
        h1 code, h2 code, h3 code, h4 code {
          font-size: 0.9em;
          background: var(--code-bg);
          color: var(--primary-color);
        }

        /* Lists */
        ul, ol {
          margin: 1rem 0 1rem 2rem;
        }

        li {
          margin-bottom: 0.5rem;
        }

        /* Badges and Labels */
        img[alt*="badge"], img[alt*="Badge"] {
          display: inline-block;
          margin: 0.25rem;
        }

        /* Tables */
        table {
          width: 100%;
          border-collapse: collapse;
          margin: 1.5rem 0;
          overflow: hidden;
          border-radius: 8px;
          box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        th, td {
          padding: 0.75rem;
          text-align: left;
          border-bottom: 1px solid var(--border-color);
        }

        th {
          background: var(--bg-secondary);
          font-weight: 600;
          color: var(--primary-color);
        }

        tr:hover {
          background: var(--bg-secondary);
        }

        /* Blockquotes */
        blockquote {
          border-left: 4px solid var(--primary-color);
          padding-left: 1rem;
          margin: 1.5rem 0;
          color: var(--text-light);
          font-style: italic;
          background: var(--bg-secondary);
          padding: 1rem 1rem 1rem 2rem;
          border-radius: 0 8px 8px 0;
        }

        /* HR */
        hr {
          border: none;
          border-top: 2px solid var(--border-color);
          margin: 2rem 0;
        }

        /* Footer */
        footer {
          background: var(--bg-secondary);
          padding: 2rem 0;
          text-align: center;
          color: var(--text-light);
          border-top: 1px solid var(--border-color);
        }

        footer p {
          margin: 0.5rem 0;
        }

        footer a {
          color: var(--primary-color);
          margin: 0 0.5rem;
        }

        /* Checkboxes */
        input[type="checkbox"] {
          margin-right: 0.5rem;
        }

        /* Badges */
        .badge {
          display: inline-block;
          padding: 0.25rem 0.75rem;
          background: var(--primary-color);
          color: white;
          border-radius: 12px;
          font-size: 0.875rem;
          font-weight: 500;
          margin: 0.25rem;
        }

        /* Special sections */
        .content > p:first-child {
          font-size: 1.125rem;
          color: var(--text-light);
        }

        /* Directory structure styling */
        ul ul {
          margin-top: 0.5rem;
        }

        /* Anchor links */
        .header-anchor {
          opacity: 0;
          transition: opacity 0.2s;
          margin-left: -1.5rem;
          padding-right: 0.5rem;
          color: var(--primary-color);
        }

        h2:hover .header-anchor,
        h3:hover .header-anchor,
        h4:hover .header-anchor {
          opacity: 1;
        }

        /* Responsive */
        @media (max-width: 768px) {
          .container {
            padding: 0 1rem;
          }

          .content {
            padding: 1.5rem;
          }

          .nav-links {
            gap: 1rem;
            font-size: 0.9rem;
          }

          .github-link span {
            display: none;
          }

          h1 {
            font-size: 2rem;
          }

          h2 {
            font-size: 1.5rem;
          }

          pre {
            padding: 1rem;
          }

          table {
            font-size: 0.875rem;
          }

          th, td {
            padding: 0.5rem;
          }
        }

        /* Smooth scrolling */
        html {
          scroll-behavior: smooth;
        }

        /* Selection color */
        ::selection {
          background: var(--primary-color);
          color: white;
        }

        /* Cheatsheet Grid */
        .cheatsheet-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
          gap: 1.5rem;
          margin: 1.5rem 0 2.5rem 0;
        }

        .cheatsheet-card {
          background: var(--bg-secondary);
          padding: 1.5rem;
          border-radius: 8px;
          border: 2px solid var(--border-color);
          transition: all 0.2s ease;
        }

        .cheatsheet-card:hover {
          border-color: var(--primary-color);
          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
          transform: translateY(-2px);
        }

        .cheatsheet-card h3 {
          margin: 0 0 0.5rem 0;
          font-size: 1.25rem;
        }

        .cheatsheet-card h3 a {
          color: var(--text-color);
          text-decoration: none;
        }

        .cheatsheet-card h3 a:hover {
          color: var(--primary-color);
        }

        .cheatsheet-card p {
          margin: 0;
          font-size: 0.9rem;
        }

        .read-more {
          color: var(--primary-color);
          font-weight: 500;
        }

        .intro {
          font-size: 1.125rem;
          color: var(--text-light);
          margin-bottom: 2rem;
        }

        /* Images */
        img {
          max-width: 100%;
          height: auto;
          border-radius: 8px;
          margin: 1rem 0;
          box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* Cheatsheet Page Styling */
        .cheatsheet-header {
          margin-bottom: 2rem;
          padding-bottom: 1rem;
          border-bottom: 2px solid var(--border-color);
        }

        .cheatsheet-header h1 {
          margin-top: 1rem;
          margin-bottom: 0;
          font-size: 2.25rem;
        }

        .back-link {
          display: inline-flex;
          align-items: center;
          color: var(--primary-color);
          text-decoration: none;
          font-weight: 500;
          padding: 0.5rem 1rem;
          border-radius: 6px;
          background: var(--bg-secondary);
          transition: all 0.2s;
        }

        .back-link:hover {
          background: var(--primary-color);
          color: white;
          text-decoration: none;
        }

        /* Table of Contents */
        .toc {
          background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
          padding: 1.5rem 2rem;
          border-radius: 8px;
          margin: 2rem 0;
          border-left: 4px solid var(--primary-color);
          box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
        }

        .toc h2 {
          margin: 0 0 1rem 0;
          font-size: 1.25rem;
          color: var(--primary-color);
          border-top: none;
          padding-top: 0;
        }

        .toc ul {
          list-style: none;
          padding: 0;
          margin: 0;
        }

        .toc ul li {
          padding: 0.5rem 0;
          margin: 0;
        }

        .toc ul li:before {
          content: "‚ñ∏";
          margin-right: 0.5rem;
          color: var(--primary-color);
          font-weight: bold;
        }

        .toc ul li.toc-sub {
          padding-left: 1.5rem;
          font-size: 0.95rem;
        }

        .toc ul li.toc-sub:before {
          content: "‚ó¶";
          color: var(--secondary-color);
        }

        .toc a {
          color: var(--text-color);
          text-decoration: none;
          transition: color 0.2s;
        }

        .toc a:hover {
          color: var(--primary-color);
          text-decoration: none;
        }

        .cheatsheet-content {
          margin: 2rem 0;
        }

        /* Section backgrounds */
        .cheatsheet-content > h2 {
          margin-top: 3rem;
          padding: 1.5rem 1.5rem 1.5rem 2rem;
          border-top: none;
          font-size: 1.75rem;
          color: white;
          background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
          border-radius: 8px;
          box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
          position: relative;
          margin-left: -1rem;
          margin-right: -1rem;
          padding-left: 2rem;
        }

        .cheatsheet-content > h2:first-child {
          margin-top: 0;
        }

        .cheatsheet-content h2:before {
          content: "üìö";
          position: absolute;
          left: 0.75rem;
          top: 50%;
          transform: translateY(-50%);
          font-size: 1.5rem;
        }

        .cheatsheet-content h3 {
          color: white;
          margin-top: 2rem;
          font-size: 1.35rem;
          font-weight: 600;
          padding: 1rem 1.5rem;
          background: linear-gradient(135deg, var(--accent-color) 0%, #a855f7 100%);
          border-radius: 6px;
          box-shadow: 0 2px 6px rgba(139, 92, 246, 0.15);
          border: none;
        }

        .cheatsheet-content h4 {
          color: var(--secondary-color);
          font-size: 1.1rem;
          font-weight: 600;
          margin-top: 1.5rem;
          padding: 0.75rem 1rem;
          background: var(--bg-secondary);
          border-left: 4px solid var(--accent-color);
          border-radius: 4px;
        }

        /* Enhanced code blocks */
        .cheatsheet-content pre {
          background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
          color: #e2e8f0;
          padding: 1.5rem;
          border-radius: 8px;
          overflow-x: auto;
          border-left: 4px solid #10b981;
          box-shadow: 0 4px 12px rgba(0,0,0,0.2);
          margin: 1.5rem 0;
          position: relative;
        }

        .cheatsheet-content pre:before {
          content: "Code";
          position: absolute;
          top: 0.5rem;
          right: 1rem;
          font-size: 0.75rem;
          color: #64748b;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .cheatsheet-content pre code {
          color: #e2e8f0;
          font-size: 0.9rem;
          line-height: 1.7;
        }

        .cheatsheet-content code {
          background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
          color: #e83e8c;
          padding: 0.25rem 0.6rem;
          border-radius: 4px;
          font-size: 0.9em;
          font-weight: 500;
          border: 1px solid #f9a8d4;
        }

        .cheatsheet-content pre code {
          background: transparent;
          padding: 0;
          border: none;
        }

        /* Better list styling */
        .cheatsheet-content ul {
          list-style: none;
          padding-left: 0;
          background: #f8fafc;
          padding: 1rem 1.5rem;
          border-radius: 6px;
          margin: 1rem 0;
          border-left: 3px solid var(--primary-color);
        }

        .cheatsheet-content ul li {
          padding-left: 1.5rem;
          position: relative;
          margin-bottom: 0.75rem;
          line-height: 1.7;
        }

        .cheatsheet-content ul li:before {
          content: "‚ñ∏";
          position: absolute;
          left: 0;
          color: var(--primary-color);
          font-weight: bold;
          font-size: 1.1em;
        }

        .cheatsheet-content ul ul {
          margin-top: 0.5rem;
          padding: 0.5rem 0 0.5rem 1.5rem;
          background: transparent;
          border-left: 2px solid var(--accent-color);
        }

        .cheatsheet-content ul ul li:before {
          content: "‚ó¶";
          color: var(--accent-color);
        }

        .cheatsheet-content ol {
          padding-left: 2rem;
          background: #fef3c7;
          padding: 1rem 1.5rem 1rem 3rem;
          border-radius: 6px;
          margin: 1rem 0;
          border-left: 3px solid #f59e0b;
        }

        .cheatsheet-content ol li {
          margin-bottom: 0.75rem;
          line-height: 1.7;
        }

        .cheatsheet-content ol li::marker {
          color: #f59e0b;
          font-weight: bold;
        }

        /* Cheatsheet footer */
        .cheatsheet-footer {
          margin-top: 3rem;
          padding-top: 2rem;
          border-top: 2px solid var(--border-color);
          display: flex;
          justify-content: space-between;
          align-items: center;
          flex-wrap: wrap;
          gap: 1rem;
        }

        .github-edit {
          display: inline-flex;
          align-items: center;
          color: var(--text-light);
          text-decoration: none;
          font-size: 0.9rem;
          transition: color 0.2s;
        }

        .github-edit:hover {
          color: var(--primary-color);
        }

        /* Paragraphs in cheatsheet */
        .cheatsheet-content > p {
          background: #fefce8;
          padding: 1rem 1.5rem;
          border-radius: 6px;
          margin: 1rem 0;
          line-height: 1.8;
          border-left: 3px solid #eab308;
        }

        /* Blockquote in cheatsheets */
        .cheatsheet-content blockquote {
          background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
          border-left: 4px solid #10b981;
          color: var(--text-color);
          font-style: normal;
          padding: 1.25rem 1.75rem;
          border-radius: 6px;
          box-shadow: 0 2px 8px rgba(16, 185, 129, 0.1);
          margin: 1.5rem 0;
          position: relative;
        }

        .cheatsheet-content blockquote:before {
          content: "üí°";
          position: absolute;
          top: 1.25rem;
          left: -0.5rem;
          font-size: 1.5rem;
          background: white;
          border-radius: 50%;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .cheatsheet-content blockquote p {
          margin: 0;
          padding-left: 1.5rem;
        }

        .cheatsheet-content blockquote p:first-child {
          font-weight: 500;
        }

        /* Table improvements */
        .cheatsheet-content table {
          font-size: 0.95rem;
          background: white;
          margin: 1.5rem 0;
        }

        .cheatsheet-content table thead {
          background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
        }

        .cheatsheet-content table th {
          color: white;
          font-weight: 600;
          padding: 1rem 0.75rem;
        }

        .cheatsheet-content table td {
          padding: 0.875rem 0.75rem;
        }

        .cheatsheet-content table tbody tr:nth-child(even) {
          background: #f8fafc;
        }

        .cheatsheet-content table tbody tr:hover {
          background: #e0f2fe;
        }

        .cheatsheet-content table code {
          font-size: 0.85rem;
        }

        @media (max-width: 768px) {
          .cheatsheet-grid {
            grid-template-columns: 1fr;
            gap: 1rem;
          }

          .cheatsheet-footer {
            flex-direction: column;
            align-items: flex-start;
          }

          .cheatsheet-content pre {
            padding: 1rem;
            font-size: 0.85rem;
          }

          .cheatsheet-header h1 {
            font-size: 1.75rem;
          }

          .cheatsheet-content > h2 {
            font-size: 1.5rem;
            padding: 1rem 1rem 1rem 2.5rem;
            margin-left: 0;
            margin-right: 0;
          }

          .cheatsheet-content h2:before {
            font-size: 1.2rem;
            left: 0.5rem;
          }

          .cheatsheet-content h3 {
            font-size: 1.2rem;
            padding: 0.875rem 1rem;
          }

          .cheatsheet-content h4 {
            font-size: 1rem;
            padding: 0.625rem 0.875rem;
          }

          .toc {
            padding: 1rem 1.25rem;
          }

          .toc h2 {
            font-size: 1.1rem;
          }

          .cheatsheet-content > p {
            padding: 0.875rem 1rem;
            font-size: 0.95rem;
          }

          .cheatsheet-content ul,
          .cheatsheet-content ol {
            padding: 0.875rem 1rem;
            font-size: 0.95rem;
          }

          .cheatsheet-content blockquote {
            padding: 1rem 1.25rem;
            padding-left: 2rem;
          }

          .cheatsheet-content blockquote:before {
            left: -0.75rem;
            font-size: 1.25rem;
            width: 1.75rem;
            height: 1.75rem;
          }

          .cheatsheet-content table {
            font-size: 0.85rem;
          }

          .cheatsheet-content table th,
          .cheatsheet-content table td {
            padding: 0.625rem 0.5rem;
          }
        }
        EOFCSS

    - name: Create 404 page
      run: |
        cat > _site/404.html << 'EOF404'
        <!DOCTYPE html>
        <html lang="en">
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>404 - Page Not Found</title>
          <link rel="stylesheet" href="/style.css">
        </head>
        <body>
          <div class="container" style="text-align: center; padding: 4rem 2rem;">
            <h1 style="font-size: 4rem; margin-bottom: 1rem;">404</h1>
            <h2>Page Not Found</h2>
            <p style="margin: 2rem 0;">The page you're looking for doesn't exist.</p>
            <a href="/" style="display: inline-block; padding: 0.75rem 1.5rem; background: var(--primary-color); color: white; border-radius: 6px; text-decoration: none;">Go Home</a>
          </div>
        </body>
        </html>
        EOF404

    - name: Upload artifact
      uses: actions/upload-pages-artifact@v3

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build

    steps:
    - name: Deploy to GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v4
